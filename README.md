# Custom Auth & Permissions System (Test Assignment)

Привет! Это реализация тестового задания по созданию системы аутентификации и гибкого управления доступом. 

Основной упор я сделал на то, чтобы система была расширяемой. Вместо стандартных групп Django я реализовал свою структуру разрешений, которая позволяет гибко настраивать доступ не только для ролей, но и для конкретных пользователей на конкретные ресурсы.

## Как запустить

1. **Окружение**: Тут всё стандартно. Версия Python 3.10+.
   ```bash
   python -m venv venv
   .\venv\Scripts\activate  # Windows
   pip install -r requirements.txt
   ```

2. **База**: Я использовал SQLite для простоты демонстрации (не нужно разворачивать Postgres), но в `settings.py` всё готово для переезда на нормальную БД.
   ```bash
   python manage.py migrate
   python manage.py seed_data  # Заполнит базу тестовыми юзерами и правами
   ```

3. **Запуск**:
   ```bash
   python manage.py runserver
   ```
   После запуска можно зайти в Swagger: `http://127.0.0.1:8000/api/docs/` — там удобнее всего дергать ручки.

## Что внутри (Архитектура прав)

Я решил отойти от стандартного `BasePermission` в пользу более прозрачной схемы. Права проверяются в три этапа (по приоритету):
1. **Resource Level**: Если мы явно дали (или запретили) доступ к конкретному документу ID=5. Это самое сильное правило.
2. **User Level**: Прямые права юзера (например, "этому человеку можно всё, независимо от роли").
3. **Role Level**: Типичная RBAC (админ, менеджер и т.д.).

Логика проверки вынесена в отдельный сервис `permissions_system/services.py`, так её проще тестировать и использовать во вьюхах через декораторы или кастомный Permission-класс.

## Аккаунты

Тут всё по ТЗ:
- Регистрация и логин через email.
- JWT токены (SimpleJWT).
- Мягкое удаление (`is_active=False`). При удалении юзер сразу вылетает из системы (черный список токенов).

## Мысли по реализации (Саморецензия)
- **Почему не группы Django?** Потому что в ТЗ просили "собственную систему доступа". Группы Django слишком ограничены, если нужно реализовать доступ к конкретным объектам (Object-level permissions).
- **Что можно улучшить?** 
  - Добавить кеширование прав (например, в Redis), чтобы не дергать базу на каждый запрос.
  - Реализовать наследование ролей.
  - Сделать более удобный интерфейс для админа (пока только через API).

### Тестовые доступы:
- `admin@test.com` / `admin123` (Админ, может всё)
- `manager@test.com` / `manager123` (Может читать и править доки)
- `viewer@test.com` / `viewer123` (Только смотреть)

Надеюсь, код будет понятным!
